---
import { getCollection } from 'astro:content';
import type { CollectionEntry } from 'astro:content';
import Layout from '@layouts/Default.astro';
import { Card } from '@eliancodes/brutal-ui';
import BuyMeCoffee from '@components/generic/BuyMeCoffee.astro';

export async function getStaticPaths() {
  const blogEntries = await getCollection('blog');
  return blogEntries.map((blogpost) => ({
    params: { slug: blogpost.slug },
    props: { blogpost },
  }));
}

interface Props {
  blogpost: CollectionEntry<'blog'>;
}

const { blogpost } = Astro.props;
const { Content } = await blogpost.render();
const { title, description, author } = blogpost.data;
const pubDate = new Date(blogpost.data.pubDate);
---

<Layout title={title} description={description}>
  <main class="bg-#e4a6ca p-6">
    <article class="max-w-4xl mx-auto">
      <Card color="#ffffff">
        <header class="mb-8">
          <h1 class="text-3xl md:text-5xl lg:text-6xl mb-4 dm-serif">{title}</h1>
          <div class="flex gap-4 text-sm poppins text-gray-600 mb-4">
            <time datetime={pubDate.toISOString()}>
              {pubDate.toLocaleDateString('es-ES', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
              })}
            </time>
            <span>•</span>
            <span>{author}</span>
          </div>
          <div class="bg-gray-50 p-4 rounded-lg border-2 border-black mb-6">
            <p class="poppins text-lg italic text-gray-700">{description}</p>
          </div>
        </header>

        <div class="prose prose-lg max-w-none poppins">
          <Content />
        </div>

        <BuyMeCoffee username="rollingpeaches" />

        <div class="flex justify-center mt-6">
          <img
            src="https://raw.githubusercontent.com/MarinaLopez98/Maaz-Peaches/master/src/assets/Peach.jpg"
            alt="Ilustración Peach"
            class="rounded-lg border-2 border-black shadow-lg"
            style="max-width: 300px; width: 100%;"
            loading="lazy"
          />
        </div>
      </Card>
    </article>
  </main>
</Layout>
